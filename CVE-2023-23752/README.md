# Joomla CVE-2023-23752 Scanner

## Description

Detects the version of Joomla CMS by analyzing the `/language/en-GB/install.xml` file. This script supports custom Joomla directory path.

## Usage

Example usage: `nmap -p80 --script CVE-2023-23752.nse --script-args joomla-dir=/customdir`

Note: The custom directory path should start with a forward slash ("/")
Example: `--script-args joomla-dir=/myjoomladir`
Do not use spaces in the directory path.

## Author

masta ghimau | https://github.com/gh1mau | https://www.youtube.com/@mastaghimau3881

## Categories

- default
- vuln


_This script detects the version of Joomla CMS by analyzing the /language/en-GB/install.xml file. It also checks for a specific vulnerability (CVE-2023-23752) that exists in Joomla versions 4.0.0 to 4.2.7._

_The user can provide a custom Joomla directory path using the --joomla-dir option. The default Joomla directory path is /joomla. The script defines two functions: detect\_joomla\_version() and check\_cve\_2023\_23752\_vuln(). The detect\_joomla\_version() function takes the host IP address, port number, and Joomla directory path as arguments, and sends an HTTP GET request to the /language/en-GB/install.xml file to get the Joomla version number. The function then returns the version number if it is found in the response body._

_The check\_cve\_2023\_23752\_vuln() function also takes the host IP address, port number, and Joomla directory path as arguments, and sends an HTTP GET request to the same file. The function then checks if the version number is between 4.0.0 and 4.2.7 (inclusive), and returns true if the vulnerability is present and false otherwise._

_The action() function is executed when the script is run. It calls the detect\_joomla\_version() function to get the Joomla version number and saves it in the version variable. If the version number is found, the function checks if the CVE-2023-23752 vulnerability is present by calling the check\_cve\_2023\_23752\_vuln() function. If the vulnerability is present, the function sends an HTTP GET request to /api/index.php/v1/config/application?public=true and extracts the username, password, and database from the response body using the extract\_info() function. The function then prints a message with the Joomla version number and the extracted user, password, and database information if they are found._
